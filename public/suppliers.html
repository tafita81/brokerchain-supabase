<!DOCTYPE html>
<html lang="en" style="background:#000;color:#fff;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1.0"/>
<title>BrokerChain • Suppliers</title>
<style>
body{margin:0;padding:16px;background:#000;color:#fff;font-size:16px;line-height:1.4rem;}
h1{margin:0 0 12px 0;font-size:1.1rem;font-weight:600;color:#fff;}
.small{font-size:0.75rem;color:#aaa;line-height:1rem;margin-bottom:12px;}
.table-wrap{border:1px solid #333;border-radius:8px;overflow-x:auto;font-size:0.7rem;line-height:1rem;}
table{width:100%;border-collapse:collapse;min-width:800px;}
th,td{border-bottom:1px solid #333;text-align:left;padding:6px 8px;vertical-align:top;color:#fff;font-weight:400;}
.btn{display:inline-block;background:#111;color:#fff;border:1px solid #444;border-radius:6px;font-size:0.8rem;padding:8px 10px;text-decoration:none;margin-right:8px;}
.btn:active{background:#222;}
.header-row{display:flex;flex-wrap:wrap;align-items:flex-start;gap:8px;margin-bottom:12px;}
</style>
</head>
<body>

<div class="header-row">
  <a class="btn" href="/dashboard.html">← Dashboard</a>
  <h1 style="flex:1;min-width:200px;">Suppliers Standby</h1>
</div>

<div class="small">
Fornecedores/instaladores/field crews e também quem entrega peça ou faz instalação.
“active:true” = esse fornecedor está de plantão para receber job pago.
Quando APPROVED_OUTREACH=true e tudo verde, fazemos ping diário automático
pra confirmar se ele continua pronto.
</div>

<div class="table-wrap">
  <table id="sup_table">
    <thead>
      <tr>
        <th>ID</th>
        <th>Tenant</th>
        <th>State</th>
        <th>Active</th>
        <th>Capability</th>
        <th>Contact</th>
        <th>Notes</th>
        <th>Last Update (UTC)</th>
      </tr>
    </thead>
    <tbody id="sup_tbody">
      <tr><td colspan="8">Loading…</td></tr>
    </tbody>
  </table>
</div>

<script>
async function loadSuppliers(){
  const r = await fetch('/api/suppliers-all');
  const j = await r.json();
  const arr = j.suppliers || [];
  const tbody = document.getElementById('sup_tbody');
  tbody.innerHTML = "";
  arr.slice().reverse().forEach(S => {
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td>${S.id||''}</td>
      <td>${S.tenant||''}</td>
      <td>${S.state||''}</td>
      <td>${S.active ? 'YES':'no'}</td>
      <td>${(S.capability||'').replace(/</g,'&lt;')}</td>
      <td>${(S.contact_email||'') + ' ' + (S.contact_phone||'')}</td>
      <td>${(S.notes||'').replace(/</g,'&lt;')}</td>
      <td>${S.last_update_utc||''}</td>
    `;
    tbody.appendChild(tr);
  });
}
loadSuppliers();
</script>

</body>
</html>
