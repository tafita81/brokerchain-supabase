<!DOCTYPE html>
<html lang="en" style="background:#000;color:#fff;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1.0"/>
<title>BrokerChain • Leads History</title>
<style>
body{margin:0;padding:16px;background:#000;color:#fff;font-size:16px;line-height:1.4rem;}
h1{margin:0 0 12px 0;font-size:1.1rem;font-weight:600;color:#fff;}
.small{font-size:0.75rem;color:#aaa;line-height:1rem;margin-bottom:12px;}
.table-wrap{border:1px solid #333;border-radius:8px;overflow-x:auto;font-size:0.7rem;line-height:1rem;}
table{width:100%;border-collapse:collapse;min-width:800px;}
th,td{border-bottom:1px solid #333;text-align:left;padding:6px 8px;vertical-align:top;color:#fff;font-weight:400;}
.btn{display:inline-block;background:#111;color:#fff;border:1px solid #444;border-radius:6px;font-size:0.8rem;padding:8px 10px;text-decoration:none;margin-right:8px;}
.btn:active{background:#222;}
.header-row{display:flex;flex-wrap:wrap;align-items:flex-start;gap:8px;margin-bottom:12px;}
</style>
</head>
<body>

<div class="header-row">
  <a class="btn" href="/dashboard.html">← Dashboard</a>
  <h1 style="flex:1;min-width:200px;">Leads History</h1>
</div>

<div class="small">
Todos os leads reais já capturados pelo crawler e pela IA. Isso é seu ouro bruto.
Quando PRODUCTION_READY=true, esses leads podem virar DocuSign + Stripe.
</div>

<div class="table-wrap">
  <table id="leads_table">
    <thead>
      <tr>
        <th>UTC</th>
        <th>State</th>
        <th>Tenant</th>
        <th>Urgency</th>
        <th>&lt;15k auth</th>
        <th>Contact</th>
        <th>Title / Body</th>
        <th>Source URL</th>
      </tr>
    </thead>
    <tbody id="leads_tbody">
      <tr><td colspan="8">Loading…</td></tr>
    </tbody>
  </table>
</div>

<script>
async function loadLeads(){
  const r = await fetch('/api/leads-all');
  const j = await r.json();
  const leads = j.leads || [];
  const tbody = document.getElementById('leads_tbody');
  tbody.innerHTML = "";
  leads.slice().reverse().forEach(L => {
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td>${L.created_utc||''}</td>
      <td>${L.state||''}</td>
      <td>${L.tenant||''}</td>
      <td>${L.urgency||''}</td>
      <td>${L.authorized_under_15k ? 'YES':'no'}</td>
      <td>${(L.contact_email||L.contact_phone||'')}</td>
      <td>${(L.title||'')} / ${(L.body||'').substring(0,200)
        .replace(/</g,'&lt;')}</td>
      <td>${(L.source_url||'').replace(/</g,'&lt;')}</td>
    `;
    tbody.appendChild(tr);
  });
}
loadLeads();
</script>

</body>
</html>
